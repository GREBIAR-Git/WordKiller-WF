# Лабораторная 7

Контрольные вопросы:

    1. Что такое объект COM?

COM (англ. Component Object Model «модель компонентного объекта») — это технологический стандарт от компании Microsoft, предназначенный для создания программного обеспечения на основе взаимодействующих компонентов объекта, каждый из которых может использоваться во многих программах одновременно. Стандарт воплощает в себе идеи полиморфизма и инкапсуляции объектно-ориентированного программирования. Стандарт COM мог бы быть универсальным и платформо-независимым, но закрепился в основном на операционных системах семейства Microsoft Windows. В современных версиях Windows COM используется очень широко.

    2. Чем отличаются СОМ объекты от обычных объектов?

СОМ-объекты похожи на обычные объекты. В отличие от объектов, СОМ-объекты содержат свойства, методы и интерфейсы. Обычный СОМ-объект включает в себя один или несколько интерфейсов. Каждый из этих интерфейсов имеет собственный указатель.

    3. Объясните основные принципы построения архитектуры приложения на основе com объектов?

COM - технологии, обеспечивающие взаимодействие между компонентами приложения и позволяющие развертывать распределенное приложение на платформе Windows. COM является моделью программирования на основе объектов, которая упрощает взаимодействие различных приложений и компонентов.

    4. Расскажите о порядке работы с com-объектами?

Клиент может содержать прямую ссылку на СОМ-объект только в одном случае — когда СОМ-объект размещен в сервере «в процессе». В случае локального или удаленного сервера он ссылается на посредника. Посредник — СОМ-объект, размещенный в клиентском процессе и предоставляющий клиенту те же интерфейсы, что и запрашиваемый объект. Запрос клиентом операции через такую ссылку приводит к исполнению кода посредника. Посредник принимает параметры, переданные клиентом, и упаковывает их для дальнейшей пересылки. Затем посредник (с помощью средства коммуникации) посылает запрос в процесс, который на самом деле реализует СОМ-объект. По прибытии в процесс локального сервера запрос передается заглушке. Заглушка распаковывает параметры запроса и вызывает операцию СОМ-объекта. После завершения СОМ-операции результаты возвращаются в обратном направлении. Код посредника и заглушки автоматически генерируется компилятором MIDL (Microsoft IDL) по IDL-описанию интерфейса. Библиотека типа определяет важные для клиента характеристики СОМ-объекта: имя его класса, поддерживаемые интерфейсы, имена и адреса элементов интерфейса. Описание библиотеки типа начинается с ее уникального имени (записывается после служебного слова uuid), затем указывается номер версии библиотеки. После служебного слова library записывается символьное имя библиотеки. Далее в операторе importlib указывается файл со стандартными определениями IDL - stdole32.tlb. Тело описания библиотеки включает только один элемент — СОМ-класс (coclass), на основе которого создается СОМ-объект. В начале описания СОМ-класса приводится его уникальное имя (это и есть идентификатор класса — CLSID). В теле класса перечислены имена поддерживаемых интерфейсов.

    5. Опишите преимущества и недостатки архитектуры, основанной на com объектах?

Преимущества COM
-СОМ обеспечивает удобный способ фиксации услуг, предоставляемых разными фрагментами ПО.
-Общий подход к созданию всех типов программных услуг в СОМ упрощает проблемы разработки.
-СОМ безразличен язык программирования, на котором пишутся СОМ-объекты и клиенты.
-СОМ обеспечивает эффективное управление изменением программ — замену текущей версии компонента на новую версию с дополнительными возможностями.

Недостатки COM
-компоненты COM могут быть трудными для кодирования.
-компоненты COM могут оказаться трудными для развертывания.
